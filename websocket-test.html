<!DOCTYPE html>
<!--
    ========================================
    WebSocket ì‹¤ì‹œê°„ ì•Œë¦¼ í…ŒìŠ¤íŠ¸ í˜ì´ì§€
    ========================================
    
    ğŸ“‹ í…ŒìŠ¤íŠ¸ ë°©ë²•:
    
    1. í„°ë¯¸ë„ì—ì„œ ì›¹ ì„œë²„ ì‹¤í–‰:
       cd ../HotDeal í”„ë¡œì íŠ¸ ê²½ë¡œ
       python3 -m http.server 3000
       
    2. ë¸Œë¼ìš°ì €ì—ì„œ í˜ì´ì§€ ì—´ê¸°:
       http://localhost:3000/websocket-test.html
       
    3. Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ í™•ì¸ (8080 í¬íŠ¸)
       
    4. ì´ë²¤íŠ¸ ìƒì„± API í˜¸ì¶œ:
       POST http://localhost:8080/api/event/create
       Content-Type: application/json
       
       {
         "eventType": "HOT_DEAL",
         "eventDiscount": 20,
         "eventDuration": 7,
         "startEventTime": "2025-01-15T00:00:00",
         "productIds": [1, 2, 3]
       }
       
    5. ë¸Œë¼ìš°ì €ì—ì„œ ì‹¤ì‹œê°„ ì•Œë¦¼ í™•ì¸
       
    6. í…ŒìŠ¤íŠ¸ ì™„ë£Œ í›„ ì›¹ ì„œë²„ ì¢…ë£Œ:
       í„°ë¯¸ë„ì—ì„œ Ctrl+C ë˜ëŠ”
       lsof -ti:3000 | xargs kill -9
       
    ========================================
-->
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket Test</title>
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client@1/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>
</head>
<body>
    <h1>WebSocket ì•Œë¦¼ í…ŒìŠ¤íŠ¸</h1>
    <div id="messages"></div>
    
    <script>
        const socket = new SockJS('http://localhost:8080/ws');
        const stompClient = Stomp.over(socket);
        
        stompClient.connect({}, function(frame) {
            console.log('Connected: ' + frame);
            document.getElementById('messages').innerHTML += '<p>âœ… ì›¹ì†Œì¼“ ì—°ê²° ì„±ê³µ</p>';
            
            stompClient.subscribe('/topic/notification', function(message) {
                console.log('ì•Œë¦¼ ë°›ìŒ:', message.body);
                document.getElementById('messages').innerHTML += '<p>ğŸ”” ì•Œë¦¼: ' + message.body + '</p>';
            });
        }, function(error) {
            console.log('STOMP error: ' + error);
            document.getElementById('messages').innerHTML += '<p>âŒ ì—°ê²° ì‹¤íŒ¨: ' + error + '</p>';
        });
        
        // ì—°ê²° ìƒíƒœ ëª¨ë‹ˆí„°ë§
        window.addEventListener('beforeunload', function() {
            if (stompClient.connected) {
                stompClient.disconnect();
            }
        });
    </script>
</body>
</html> 